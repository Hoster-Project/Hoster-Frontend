ğŸ§± 1ï¸âƒ£ Never Trust the Frontend (Golden Rule)

Frontend security = protection layer
Backend security = real enforcement

Anything in:

localStorage

JS variables

hidden inputs

disabled buttons

âŒ Can be manipulated.

ğŸ” 2ï¸âƒ£ Environment Variables Safety
âœ… Use correct prefixes

Only expose public variables:

NEXT_PUBLIC_API_URL=https://api.example.com


Anything without NEXT_PUBLIC_ stays server-only.

Never expose:

API secrets

DB URLs

Private keys

JWT secret

ğŸ›¡ 3ï¸âƒ£ Content Security Policy (CSP) â€” CRITICAL

Add security headers in next.config.js:

const securityHeaders = [
  {
    key: "Content-Security-Policy",
    value:
      "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self' https://api.example.com;",
  },
  {
    key: "X-Frame-Options",
    value: "DENY",
  },
  {
    key: "X-Content-Type-Options",
    value: "nosniff",
  },
  {
    key: "Referrer-Policy",
    value: "strict-origin-when-cross-origin",
  },
];


This prevents:

XSS

Clickjacking

MIME sniffing

ğŸš« 4ï¸âƒ£ Prevent XSS (Cross-Site Scripting)
NEVER use:
dangerouslySetInnerHTML


Unless:

You sanitize content first

Use:

npm install dompurify

ğŸ”‘ 5ï¸âƒ£ Avoid Storing Tokens in localStorage

âŒ Bad:

localStorage.setItem("token", jwt);


Better:

HTTP-only cookies

SameSite=strict

Secure flag

Because:
localStorage = accessible by XSS

ğŸª 6ï¸âƒ£ Secure Cookies Setup

Cookies must be:

httpOnly: true
secure: true
sameSite: "strict"


Even if handled backend â€” frontend must expect it.

ğŸ§  7ï¸âƒ£ Protect Against CSRF

If using cookies for auth:

Backend must implement:

CSRF token

SameSite cookies

Frontend:

Include CSRF token in requests

ğŸ§¹ 8ï¸âƒ£ Remove Sensitive Console Logs

Before production:

Remove:

console.log(user);
console.log(token);


Use:

next build


With proper minification.

ğŸ“¦ 9ï¸âƒ£ Dependency Security

Run:

npm audit


Also use:

npm audit fix


And avoid:

Abandoned packages

Random small GitHub packages

ğŸ§© 1ï¸âƒ£0ï¸âƒ£ Disable Source Maps in Production

In next.config.js:

productionBrowserSourceMaps: false


This prevents exposing readable JS source.

ğŸ”’ 1ï¸âƒ£1ï¸âƒ£ Route Protection (Client-Side)

Donâ€™t rely only on:

if (!user) redirect("/login")


Because user can manipulate JS.

Real protection must be:

Middleware

Server-side validation

Use Next Middleware:

import { NextResponse } from "next/server";

export function middleware(req) {
  const token = req.cookies.get("token");
  if (!token) {
    return NextResponse.redirect(new URL("/login", req.url));
  }
}

ğŸ§Š 1ï¸âƒ£2ï¸âƒ£ Limit Third-Party Scripts

Each script:

Is potential XSS vector

Slows performance

Only use:

Necessary analytics

Verified sources

Add integrity if possible:

<script src="..." integrity="sha384-..." crossorigin="anonymous"></script>

ğŸŒ 1ï¸âƒ£3ï¸âƒ£ Prevent Clickjacking

Header:

X-Frame-Options: DENY


Or CSP:

frame-ancestors 'none'

ğŸ” 1ï¸âƒ£4ï¸âƒ£ Protect Against Open Redirects

Avoid:

router.push(searchParams.get("redirect"))


Always validate redirect URLs.

ğŸ”¥ 1ï¸âƒ£5ï¸âƒ£ Secure API Calls

Never expose:

Admin endpoints

Secret endpoints

Direct DB access

Frontend should only talk to:

Public API routes

Backend gateway

ğŸ§ª 1ï¸âƒ£6ï¸âƒ£ Rate Limiting Awareness

Frontend:

Disable spam clicks

Add loading states

Prevent multiple form submissions

But backend must enforce rate limits.

ğŸ“ 1ï¸âƒ£7ï¸âƒ£ Protect File Uploads

Frontend:

Validate file type

Limit file size

Use accept attribute

But backend must revalidate everything.

âš™ï¸ 1ï¸âƒ£8ï¸âƒ£ Use Strict Mode

In next.config.js:

reactStrictMode: true


Catches unsafe patterns.

ğŸ§  1ï¸âƒ£9ï¸âƒ£ Avoid Exposing Internal IDs

Instead of:

/user/1


Use:

UUID

Slugs

Prevents enumeration attacks.

ğŸ§¨ 2ï¸âƒ£0ï¸âƒ£ Disable Caching Sensitive Pages

For dashboard pages:

export const dynamic = "force-dynamic";


Or:

export const revalidate = 0;


Prevent caching user data.

ğŸ›‘ 2ï¸âƒ£1ï¸âƒ£ Error Handling

Donâ€™t expose:

Stack traces

Internal errors

DB messages

Use custom error pages.

ğŸš€ 2ï¸âƒ£2ï¸âƒ£ Use HTTPS Only

Never deploy HTTP.

Enable:

HSTS header

Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
